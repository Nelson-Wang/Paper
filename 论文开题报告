基于自适应算法的无源光网络节能策略研究
研究背景
随着社会信息化程度的不断提高，运营商对带宽的需求也越来越高，因此需要通过提高自身的网络速率来适应带宽日新月异的变化。目前，核心网技术的发展日趋完善，已经能够承载各种各样的新兴业务。在各种接入网技术中，无源光网络(PON)被认为是最有前景的宽带接入技术。随着无源光网络的规模逐渐增大,网络传输速率也越来越高,接入网的能源消耗问题愈加严重。业界普遍接受的观点是接入网络的能源消耗有效降低将对降低整个通信网络的能源消耗具有重要意义。
研究现状
在PON系统中，研究实现的节能技术有很多种，其中，设置ONU进入睡眠模式被认为是最有效的节能方法。JeffMandin最早由提出ONU休眠的思想，并且对于EPON的节能，在EPON网络系统的MPCP多点控制协议基础上设计了一个可扩展的睡眠协议。此后,国内外己有许多学者提出光接入网系统的ONU休眠机制,从不同的节能算法、不同的角度等方面，讨论和研究睡眠机制以及低能耗模式的最佳解决方法。
在 2011 年时 A.R.Dhaini提出了 GBA的思想，即根据上下行的数据包到达率、OLT和 ONU 的缓存大小等设计算法计算每个 ONU 的最长睡眠时间，当睡眠结束时将 OLT 和 ONU 的数据缓存传输完毕。这种方式的节能效果比较好，但仅适用于负载量比较低的 ONU，并且对时延不敏感。
同年 Y.Yan and L.Dittmann提出了两种策略：UCS（the  upstream  centric scheme），DCS（the downstream centric scheme）。在 UCS 中，OLT 缓存下行的数据直到各个ONU在上行传输时开始传输下行数据，这可以实现比较好的节能效果，但当上下行负载量不等的时候会带来比较大的时延；在 DCS 中，ONU 在上行和下行数据到来时都需要醒来进行数据传输，这可以降低上下行的时延，但节能效果相对较差。
在 2013 年 L.Zhang提出了分别考虑上下行的传输，并且分别针对上行和下行进行独立的发射机和接收机的休眠，这样的节能效果比较好，但在实际的应用中，接收机如果不考虑发射机状态的情况下进入休眠，那么在发射机工作时就无法接收到 OLT发来的控制和确认信息。
在 2015 年 G.Shagdar提出的设定固定 ONU 的睡眠时间，并且睡眠时间有短睡眠和长睡眠两种，在通过计算缓存和可最大睡眠时间来选择合适的固定睡眠时间。这样做的好处是能够让 OLT 随时知晓 ONU 的工作状态，从而不会引起丢包现象，并且产生的节能效果也比较好，但这只基于上行或者下行来考虑的，没有双向同时考虑，对系统可能会有影响。
在 2016 年 I-S.Hwang提出将 ONU 的上行数据根据时延要求进行分级，从而在数据传输时优先传输对时延要求高的数据，对于剩余的传输带宽再传输剩余的数据，如果没有剩余带宽，可以将这些数据进行缓存，直到有传输带宽时再进行传输。这样，OLT 就可以根据各个 ONU 的 REPORT 信息来决定 ONU 该采取哪种休眠方式，从而最大程度的不影响 QoS。
对于传统的 TDM-PON 系统，上、下行数据业务仅由一条波长进行传输，为了保证业务的服务质量，OLT 需要一直处于工作模式，因此对于降低 OLT 能耗很难进行管理。而在 NG-PON 中，具备多波长传输的特性，因此为了解决这个问题，可以通过关闭波长对应的光收发机来降低 OLT 能耗，基于此，有学者提出了通过迁移处于工作状态的 ONU 来关闭其中某几条波长对的OLT 节能方案。
技术路线
公司采用的是 ONU芯片是全定制ASIC 芯片，此集成芯片具有集成度更高、效率更好、能耗更低的特点。整套设计方案主要从已有的芯片功能模块汇总选取和节能相关的模块进行协调工作，从而实现无源光网络的节能方案。

在 OLT节能方案中，XPON 的节能是由 PON MAC 模块、DBA 模块（动态宽带分配模块）、LP 模块和 NP 模块协同工作完成节能功能的设计。
PON MAC 主要负责接受光模块传来的上行数据和向光模块传送下行数据。在节能方案设计中，PON MAC 模块主要实现一下功能： 
(1) 解析处理 ONU 发送的 SR（doze/sleep/awake 消息。将 SR 状态指示上报给 LOW POWER 模块（一下简称 LP 模块），用于维护 ONU 状态机进入，退出低功耗。 
(2) 根据下发授权检测 OLT上行是否有光，将有光、无光状态反馈给 StateMachine （逻辑状态机），用于状态机迁移。 
(3) PON MAC在 sleep 和 doze 模式下屏蔽 Losi 和 Lofi 中断信号。 
(4) 决策下行是否需要缓存 PLOAM/MPCP/握手 OAM 等控制报文。并在 aware 状态是下发相应控制报文。
LP模块包括状态机部分，软件部分。状态机主要是用来维护处于节能状态的 ONU 的当前状态，软件部分是用来连接上层软件，对节能进程进行软件方面的强制干涉。
软件部分实现功能： 
1）检测 OLT 上层软件是否有唤醒时间发生，有则配置唤醒指示给 LP 状态机，并修改软件本身的状态机。 
2）维护 ONU 节能状态机，根据其它模块和 LP 逻辑模块状态机上报中断给软件状态机，以及做异常检测。 
3）软件本身也可以处理 SR 消息，配置 Doze/Sleep/Normal 状态到 ONU 配置状态寄存器，并根据寄存器工作状态机维护刷新 LP 的逻辑状态机。
状态机部分会为每个低功耗ONU维护一个节能状态机，根据 PON MAC 模块的SR状态，ONU上行有光无光状态指示，迁移ONU的节能状态机，并将低功耗状态通知给DBA、节能状态机、PON MAC 和NP。同时响应NP、CPU下发的唤醒指示，通知 PON MAC 发送 PLOAM/FWI 唤醒指定ONU 。
OLT 状态机会为每一个低功耗ONU维护一个独立的节能状态机，维护状态机如上图所示，具体功能如下：
1) Doze_aware、Sleep_aware、Sleep_wait、Sleep 为低功耗状态，ONU处于低功耗状态时，OLT对ONU不进行正常的 Losi、Lofi 超时检测。 
2) Normal 为正常状态，进行正常的带宽授权，以及 Losi、Lofi 超时检测
3) Doze_aware，Sleep_aware、Sleep-wait 状态为正常响应状态，OLT DBA 对
ONU按照正常带宽进行授权，Doze、Sleep 状态，OLT DBA只为 PLOAM/OMCI/OAM通道 下发最小带宽授权。 
4) OLT通过掉线检测定时器和有光检测超时定时器对Doze/Sleep ONU进行掉线检测和假睡眠和假打盹检测。
TM模块主要包括对报文的入队和出队、报文统计、缓存管理、流量整形和调度功能，在节能方案设计中主要分作分为两部分：
1）首先负责解析软件状态机发送的低功耗报文，根据报文指示配置该 ONU对应的下行调度器出口为堵流或者放流。
2）TM负责检测对应ONU下面所有队列流量速率大小和RAM缓存存储的数据量。
	DBA是一种高效的动态调节ONU上行带宽的模块，为了支撑节能方案，需要对DBA模块进行以下修改和设计：
	1）实现ONU 和 OLT 节能时间同步，采用的是 OLT 处于从，ONU 处于主的工作模式。在 OLT 本端只维护一个状态机，但是不会为每个状态的跳变设定准确的时间，而是被动的根据 ONU 的工作状态来进行跳变。
2）本方案采用的是每帧给处于深睡眠状态的 ONU 分配低的固定带宽，并且当 ONU处于节能模式中的打盹工作状态时会分配完整的 BDA 带宽，这样可以减缓 TM模块 RAM缓存的压力。 
设计创新点

